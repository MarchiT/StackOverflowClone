@page
@model IndexModel
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "Home";
}
<label>@ViewData["Questions"]</label>

<div class="content">
    <div class="inner_content">
        <h3>Search:</h3>
        <input id="searchbar_index" type="text"><button class="go_button">GO</button>
        <h3> Or </h3>
        <form method="post">
            @if (SignInManager.IsSignedIn(User))
            {
                <div class="button">
                    <a class="askbutton" asp-page="./Create">Ask a question yourself</a>
                </div>
            }
            @if (!SignInManager.IsSignedIn(User))
            {
                <div class="button">
                    <a class="askbutton" asp-page="./Create" title="You have to be logged in to ask questions">Ask a question yourself</a>
                </div>
            }
        </form>
    </div>
</div>

<div class="questions">
    <table class="table">
        <thead>
            <tr>
                <th>Title</th>
                <th>State</th>
                <th>Vote</th>
                <th>Answers</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var contact in Model.Questions)
            {
                <tr>
                    <td><a asp-page="./Details" asp-route-id="@contact.Id">@contact.Title</a></td>
                    <td>@contact.State.ToString()</td>
                    <td>@contact.Vote</td>
                    <td>@contact.Answers.Count</td>
                    <td>
                        @if (SignInManager.IsSignedIn(User) && UserManager.GetUserId(User).Equals(contact.PublisherId))
                        {
                            <a asp-page="./Edit" asp-route-id="@contact.Id"><button class="editdeletebutton">Edit</button></a>
                            <button class="editdeletebutton" type="submit" asp-page-handler="delete" asp-route-id="@contact.Id">Delete</button>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>